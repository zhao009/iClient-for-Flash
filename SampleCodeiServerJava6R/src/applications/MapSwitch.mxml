<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" 
			   xmlns:mx="library://ns.adobe.com/flex/mx" 
			   xmlns:ic="http://www.supermap.com/iclient/2010"
			   xmlns:is="http://www.supermap.com/iserverjava/2010"
			   creationComplete="initApp()"
			   width="100%" height="100%">
	<!--地图切换-->
	<fx:Script>
		<![CDATA[		
			import utilEvent.ReadURLEvent;
			private var viewConfig:ViewConfig;
			[Bindable]
			private var worldNightUrl:String;
			[Bindable]
			private var worldDayUrl:String;
			
			//初始化
			private function initApp():void
			{
				viewConfig = new ViewConfig(this);
				this.addEventListener(ReadURLEvent.READ_COMPLETE, readURLCompelte);
			} 
			
			//获取服务地址
			private function readURLCompelte(event:ReadURLEvent):void
			{
				//获取地图服务地址，默认 IP 为：localhost
				//用户若要更改服务地址，直接修改服务地址配置文件 mapUrlConfig.xml
				//或直接在此输入地图服务地址
				//格式如：restUrl = http://localhost:8090/iserver/services/map-world/rest/maps/World Map
				this.worldDayUrl = this.viewConfig.webUrl + ViewConfig.WorldDay_MAP;
				this.worldNightUrl = this.viewConfig.webUrl + ViewConfig.WorldNight_MAP;
				titlewin.visible = true;
				
				world_check.selected = world.visible;
				world_day_check.selected = world_day.visible;
				
				world_slider.value = world.alpha * 100;
				world_day_slider.value = world_day.alpha * 100;
				
				world_slider.enabled = world.visible;
				world_day_slider.enabled = world_day.visible;
			}
			
			//CheckBox选择事件，根据选择的CheckBox显示相应的地图
			private function onCheckBoxClick():void
			{
				world.visible = world_check.selected;
				world_day.visible = world_day_check.selected;
				world_slider.enabled = world.visible;
				world_day_slider.enabled = world_day.visible;
			}
			
			//Slider滑动事件，定义地图的不透明度
			private function onSliderChange():void
			{
				world.alpha = world_slider.value / 100;
				world_day.alpha = world_day_slider.value / 100;
			}
		]]>
	</fx:Script>
	
	<!--添加地图-->
	<ic:Map id="map" scales="{[1.25e-9, 2.5e-9, 5e-9, 1e-8, 2e-8, 4e-8, 8e-8, 1.6e-7, 3.205e-7, 6.4e-7]}">
		<ic:TiledDynamicRESTLayer id="world" url="{this.worldNightUrl}"/>
		<ic:TiledDynamicRESTLayer id="world_day" url="{this.worldDayUrl}" alpha="0.5"/>
	</ic:Map>
	
	<!--定义地图切换窗口-->
	<s:Panel id="titlewin" title="地图切换：" fontFamily="宋体" fontSize="15" right="5" top="10" 
			 backgroundColor="#C9C9C9" backgroundAlpha="0.48">
		<s:VGroup width="100%" height="100%" gap="10" x="0" paddingTop="10" paddingRight="5" paddingLeft="5">
			<s:HGroup top="5"  width="100%" verticalAlign="middle">
				<mx:Label text="选择地图：" width="90"/>
				<s:HGroup gap="10">
					<s:CheckBox id="world_check" label="World_Night" click="onCheckBoxClick()" />
					<s:CheckBox id="world_day_check" label="World_Day" click="onCheckBoxClick()"/>
				</s:HGroup>
			</s:HGroup>
			<mx:HRule width="100%"/>
			<mx:Label text="透明度：" width="90"/>
			<s:HGroup width="100%" verticalAlign="middle">
				<s:Label text="World_Night：" width="108"/>
				<s:HSlider id="world_slider" minimum="0" maximum="100" focusEnabled="false"
						   liveDragging="true" width="180" change="onSliderChange()"/>
			</s:HGroup>
			<s:HGroup width="100%" bottom="5" verticalAlign="middle" gap="25">
				<s:Label text="World_Day:" width="90"/>
				<s:HSlider id="world_day_slider" minimum="0" maximum="100" focusEnabled="false"
						   liveDragging="true" width="180" change="onSliderChange()"/>
			</s:HGroup>
			<mx:Spacer height="3"/>
		</s:VGroup>
	</s:Panel>
</s:Application>
